FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGFsZXJ0LTEtYXBiCmRlc2NyaXB0aW9uOiBUaGlzIGlzIGEgc2Ft\
cGxlIGFwcGxpY2F0aW9uIGdlbmVyYXRlZCBieSBhcGIgaW5pdApiaW5kYWJsZTogRmFsc2UKYXN5\
bmM6IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBBbGVydCBNYW5hZ2VyCnBsYW5z\
OgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFRoaXMgZGVmYXVsdCBwbGFuIGRl\
cGxveXMgYWxlcnQtMS1hcGIKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFy\
YW1ldGVyczoKICAgICAgLSBuYW1lOiBUT1dFUl9VU0VSCiAgICAgICAgdGl0bGU6IFVzZXIgd2l0\
aCBwZXJtaXNzaW9ucyBvbiBUb3dlcgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVm\
YXVsdDogCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgIC0gbmFtZTogVE9XRVJfUEFTU1dPUkQK\
ICAgICAgICB0aXRsZTogUGFzc3dvcmQgZm9yIHVzZXIgd2l0aCBwZXJtaXNzaW9ucyBvbiBUb3dl\
cgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgIC0gbmFtZTog\
VE9XRVJfSk9CX1RFTVBMQVRFCiAgICAgICAgdGl0bGU6IFRlbXBsYXRlIHRvIHVzZQogICAgICAg\
IHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogIkxhdW5jaCBUZXN0IFRlbXBsYXRlIgog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAtIG5hbWU6IENPTlRFWFRfRElSCiAgICAgICAgdGl0\
bGU6IERpcmVjdG9yeSBvZiB0aGUgZ2l0IHJlcG8gdGhhdCB0aGUgY29kZSBpcyBpbgogICAgICAg\
IHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogYWxlcnRtYW5hZ2VyLXRvd2VyLWJyaWRn\
ZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAtIG5hbWU6IFNUUkFURUdZCiAgICAgICAgdGl0\
bGU6IE9DUCBidWlsZCBzdHJhdGVneQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVm\
YXVsdDogc291cmNlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgIC0gbmFtZTogTkFNRVNQQUNF\
CiAgICAgICAgdGl0bGU6IE9DUCBuYW1lc3BhY2UgdG8gcHV0IGFsZXJ0bWFuYWdlciBpbgogICAg\
ICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogc2NvbGxpZXItcHJvamVjdAogICAg\
ICAgIHR5cGU6IHN0cmluZwo="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
